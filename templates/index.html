<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TAO Analytics - Bittensor Subnet Intelligence</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Comprehensive analytics and insights for the Bittensor decentralized AI network. Real-time subnet data, bittensor on-chain data analysis, and AI-powered insights powered by TAO.app API.">
    <meta name="keywords" content="Bittensor, TAO, subnet analytics, decentralized AI, blockchain analytics, cryptocurrency, AI network, bittensor on-chain data">
    <meta name="author" content="TAO Analytics">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="{{ request.url }}">
    <meta property="og:title" content="TAO Analytics - Bittensor Subnet Intelligence">
    <meta property="og:description" content="Comprehensive analytics and insights for the Bittensor decentralized AI network. Real-time subnet data and AI-powered insights.">
    <meta property="og:image" content="{{ url_for('static', filename='favicon.png', _external=True) }}">
    
    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image">
    <meta property="twitter:url" content="{{ request.url }}">
    <meta property="twitter:title" content="TAO Analytics - Bittensor Subnet Intelligence">
    <meta property="twitter:description" content="Comprehensive analytics and insights for the Bittensor decentralized AI network. Real-time subnet data and AI-powered insights.">
    <meta property="twitter:image" content="{{ url_for('static', filename='favicon.png', _external=True) }}">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="{{ request.url }}">
    
    <!-- Favicon configuration -->
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}?v=2">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}?v=2">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='favicon.png') }}">
    <meta name="theme-color" content="#3e6ae1">
    
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="hero-section">
        <nav class="navbar">
            <div class="nav-container">
                <div class="nav-logo">
                    <a href="/" class="nav-brand">TAO Analytics</a>
                </div>
                
                <!-- Global Search Bar -->
                <div class="search-wrapper">
                    <div class="search-container">
                        <i class="fas fa-search search-icon"></i>
                        <input type="text" id="global-search-input" placeholder="Search subnets..." class="search-input">
                        <div id="search-results" class="search-results"></div>
                    </div>
                </div>
                
                <!-- Mobile menu button -->
                <button class="mobile-menu-btn" id="mobile-menu-btn">
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                    <span class="hamburger-line"></span>
                </button>
                
                <div class="nav-links" id="nav-links">
                    <a href="/dash/explorer" class="nav-link">Explorer</a>
                    <a href="/dash/screener" class="nav-link">Screener</a>
                    <a href="/dash/insights" class="nav-link">Insights</a>
                    <a href="/about" class="nav-link">About</a>
                    {% if session.admin_authenticated %}
                    <a href="/admin/system-info" class="nav-link">System Info</a>
                    <a href="/admin/logout" class="nav-link">Logout</a>
                    {% else %}
                    <a href="/admin/login" class="nav-link">Admin Login</a>
                    {% endif %}
                </div>
            </div>
        </nav>
        
        <div class="screen-size-notice">
            <span>Note: This app is designed primarily for desktop and larger screens. Mobile experience may be limited.</span>
        </div>
        
        <div class="hero-content">
            <h1 class="hero-title">Bittensor Subnet Intelligence</h1>
            <p class="hero-subtitle">
                Comprehensive analytics and insights for the decentralized AI network
            </p>
            <div class="hero-stats">
                {% if data_available %}
                <div class="stat-item" data-tooltip="Total number of active subnets in the Bittensor network with valid TAO scores">
                    <span class="stat-number">{{ network_data.total_subnets }}</span>
                    <span class="stat-label">
                        Subnets
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                    <span class="stat-note" style="font-size: 0.7em; color: #666; display: block; margin-top: 2px;">with valid TAO score</span>
                </div>
                <div class="stat-item" data-tooltip="Combined market capitalization of subnets with valid TAO scores, converted to USD using current TAO price">
                    <span class="stat-number">${{ "%.1f"|format(network_data.total_market_cap * network_data.tao_price_usd) }}M</span>
                    <span class="stat-label">
                        All Subnets Market Cap (USD)
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                    <span class="stat-usd">{{ "%.1f"|format(network_data.total_market_cap) }}M TAO</span>
                    <span class="stat-note" style="font-size: 0.7em; color: #666; display: block; margin-top: 2px;">with valid TAO score</span>
                </div>
                <div class="stat-item" data-tooltip="Total market capitalization of the TAO token (Bittensor's native token)">
                    <span class="stat-number">${{ "%.1f"|format(network_data.tao_market_cap_usd) }}M</span>
                    <span class="stat-label">
                        Bittensor Market Cap (USD)
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                </div>
                <div class="stat-item" data-tooltip="Current price of TAO token in US dollars">
                    <span class="stat-number">${{ "%.2f"|format(network_data.tao_price_usd) }}</span>
                    <span class="stat-label">
                        TAO Price (USD)
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                </div>
                <div class="stat-item" data-tooltip="Number of subnets with valid TAO scores and positive 24-hour net volume (more TAO flowing in than out)">
                    <span class="stat-number">{{ network_data.positive_flow_count }}</span>
                    <span class="stat-label">
                        Positive Flow
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                    <span class="stat-note" style="font-size: 0.7em; color: #666; display: block; margin-top: 2px;">with valid TAO score</span>
                </div>
                <div class="stat-item" data-tooltip="Percentage of subnets with valid TAO scores that have positive 24-hour net volume. Higher percentage indicates more subnets are experiencing net inflows">
                    <span class="stat-number">{{ "%.1f"|format(network_data.positive_flow_percentage) }}%</span>
                    <span class="stat-label">
                        Positive Flow %
                        <span class="tooltip-icon">‚ìò</span>
                    </span>
                    <span class="stat-note" style="font-size: 0.7em; color: #666; display: block; margin-top: 2px;">with valid TAO score</span>
                </div>
                {% else %}
                <div class="data-error-message">
                    <div class="error-icon">‚ö†Ô∏è</div>
                    <h3>Data Temporarily Unavailable</h3>
                    <p>We're experiencing issues loading network data. Please try again later or contact support if the problem persists.</p>
                    <button onclick="location.reload()" class="retry-button">Retry</button>
                </div>
                {% endif %}
            </div>
            
            <!-- Dynamic Landing Page Insights Cards -->
            {% if landing_insights and landing_insights.data_available %}
            <div class="gpt-insights-section">
                <h3 class="insights-title">
                    üìä Dynamic Network Insights
                    <span class="tooltip-icon" title="‚ö†Ô∏è DISCLAIMER: This analysis is for data transparency and educational purposes only. It is NOT financial advice. Always conduct your own research and due diligence before making any investment decisions.">‚ìò</span>
                </h3>
                <div style="background: white; border: 1px solid #e0e0e0; border-radius: 8px; padding: 12px; margin: 16px 0; font-size: 14px; color: #333;">
                    <strong>üìä Analysis Methodology:</strong> Insights are based on real-time correlation analysis and statistical outliers. Data is updated daily as new metrics become available. All metrics are calculated from on-chain data and market performance indicators.
                </div>
                <p class="insights-subtitle">Latest network analysis based on correlation data and statistical insights</p>
                
                <div class="insights-cards">
                    <!-- Hot Subnets Card -->
                    <div class="insight-card hot-subnets">
                        <div class="card-header">
                            <div class="card-icon">üî•</div>
                            <h4>Top 3 Hot Subnets</h4>
                        </div>
                        <div class="card-content">
                            {% if landing_insights.hot_subnets %}
                                {% for subnet in landing_insights.hot_subnets %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{% if subnet.name %}{{ subnet.name }} (#{{ subnet.netuid }}){% else %}Subnet #{{ subnet.netuid }}{% endif %}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">TAO Score: {{ subnet.tao_score }}</span>
                                        <span class="metric">7d: {{ subnet.price_change_7d }}%</span>
                                        <span class="metric">Flow: {{ subnet.flow_24h }}</span>
                                        <span class="metric">Score: {{ subnet.hot_score }}</span>
                                    </div>
                                    <div class="subnet-category">{{ subnet.category }}</div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No hot subnets identified</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Outliers Card -->
                    <div class="insight-card outliers">
                        <div class="card-header">
                            <div class="card-icon">üìä</div>
                            <h4>Top 3 Outliers</h4>
                        </div>
                        <div class="card-content">
                            {% if landing_insights.outliers %}
                                {% for subnet in landing_insights.outliers %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{% if subnet.name %}{{ subnet.name }} (#{{ subnet.netuid }}){% else %}Subnet #{{ subnet.netuid }}{% endif %}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">{{ subnet.metric }}: {{ subnet.value }}</span>
                                        <span class="metric">Z-Score: {{ subnet.z_score }}</span>
                                    </div>
                                    <div class="subnet-reason">{{ subnet.reason }}</div>
                                    <div class="subnet-category">{{ subnet.category }}</div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No outliers identified</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Price Momentum Card -->
                    <div class="insight-card price-momentum">
                        <div class="card-header">
                            <div class="card-icon">üìà</div>
                            <h4>Top 3 Price Momentum</h4>
                        </div>
                        <div class="card-content">
                            {% if landing_insights.price_momentum %}
                                {% for subnet in landing_insights.price_momentum %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{% if subnet.name %}{{ subnet.name }} (#{{ subnet.netuid }}){% else %}Subnet #{{ subnet.netuid }}{% endif %}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">7d: {{ subnet.price_change_7d }}%</span>
                                        <span class="metric">Flow: {{ subnet.flow_24h }}</span>
                                        <span class="metric">Momentum: {{ subnet.momentum_score }}</span>
                                    </div>
                                    <div class="subnet-category">{{ subnet.category }}</div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No momentum data available</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Hot Categories Card -->
                    <div class="insight-card hot-categories">
                        <div class="card-header">
                            <div class="card-icon">üèÜ</div>
                            <h4>
                                Top 3 Hot Categories
                                <span class="tooltip-icon" title="Multi-factor scoring: TAO Score (30%), 7d Price Change (30%), Flow Turnover (20%), Size Factor (20%). Size uses ‚àöcount to reduce bias toward larger categories.">‚ìò</span>
                            </h4>
                            <div class="card-count">{{ landing_insights.hot_categories|length }}</div>
                        </div>
                        <div class="card-content">
                            {% if landing_insights.hot_categories %}
                                {% for category in landing_insights.hot_categories %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{{ category.name }}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">Hot Score: {{ category.hot_score }}</span>
                                        <span class="metric">{{ category.subnet_count }} subnets</span>
                                    </div>
                                    <div class="subnet-reason">
                                        <strong>Performance:</strong>
                                        Avg TAO Score: {{ category.avg_tao_score }} | 
                                        7d Change: {{ category.avg_price_change_7d }}% | 
                                        Turnover: {{ category.avg_flow_turnover }}
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No category data available</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Emission Farming Watchlist Card -->
                    <div class="insight-card farmer-watchlist">
                        <div class="card-header">
                            <div class="card-icon">‚ö†Ô∏è</div>
                            <h4>
                                Emission-Farmer Watch-List ({{ landing_insights.farmer_watchlist|length }})
                                <span class="tooltip-icon" title="On-chain metrics resemble high-emission, low-utility patterns. HHI=0-1, Quality=0-100, Util=%. DYOR." class="tooltip-icon">‚ìò</span>
                            </h4>
                        </div>
                        <div class="card-subheader">
                            DYOR.
                        </div>
                        <div class="card-content">
                            {% if landing_insights.farmer_watchlist %}
                                {% for subnet in landing_insights.farmer_watchlist %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{% if subnet.name %}{{ subnet.name }} (#{{ subnet.netuid }}){% else %}Subnet #{{ subnet.netuid }}{% endif %}</div>
                                    <div class="subnet-category">{{ subnet.category|replace('/', '/') }}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">Farmer Score {{ "%.2f"|format(subnet.farmer_score) }}</span>
                                        <span class="metric">‚Äî Top concerns:
                                        {% for metric in subnet.worst_metrics %}
                                            {% if metric.metric == 'Stake HHI' %}
                                                HHI {{ "%.2f"|format(metric.contribution) }}
                                            {% elif metric.metric == 'Stake Quality' %}
                                                Quality {{ "%.2f"|format(metric.contribution) }}
                                            {% elif metric.metric == 'Validator Util' %}
                                                Util {{ "%.2f"|format(metric.contribution) }}
                                            {% else %}
                                                {{ metric.metric }} {{ "%.2f"|format(metric.contribution) }}
                                            {% endif %}
                                            {% if not loop.last %}, {% endif %}
                                        {% endfor %}
                                        </span>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No emission farming patterns detected</div>
                            {% endif %}
                        </div>
                    </div>
                    
                    <!-- Emission Farming Red Flags Card -->
                    <div class="insight-card farmer-redflags">
                        <div class="card-header">
                            <div class="card-icon">üö®</div>
                            <h4>
                                Red-Flag: Emission Farming Risk ({{ landing_insights.farmer_redflags|length }})
                                <span class="tooltip-icon" title="On-chain metrics resemble high-emission, low-utility patterns. HHI=0-1, Quality=0-100, Util=%. DYOR.">‚ìò</span>
                            </h4>
                        </div>
                        <div class="card-subheader">
                            DYOR.
                        </div>
                        <div class="card-content">
                            {% if landing_insights.farmer_redflags %}
                                {% for subnet in landing_insights.farmer_redflags %}
                                <div class="subnet-item">
                                    <div class="subnet-name">{% if subnet.name %}{{ subnet.name }} (#{{ subnet.netuid }}){% else %}Subnet #{{ subnet.netuid }}{% endif %}</div>
                                    <div class="subnet-category">{{ subnet.category|replace('/', '/') }}</div>
                                    <div class="subnet-metrics">
                                        <span class="metric">Farmer Score {{ "%.2f"|format(subnet.farmer_score) }}</span>
                                        <span class="metric">‚Äî Top concerns:
                                        {% for metric in subnet.worst_metrics %}
                                            {% if metric.metric == 'Stake HHI' %}
                                                HHI {{ "%.2f"|format(metric.contribution) }}
                                            {% elif metric.metric == 'Stake Quality' %}
                                                Quality {{ "%.2f"|format(metric.contribution) }}
                                            {% elif metric.metric == 'Validator Util' %}
                                                Util {{ "%.2f"|format(metric.contribution) }}
                                            {% else %}
                                                {{ metric.metric }} {{ "%.2f"|format(metric.contribution) }}
                                            {% endif %}
                                            {% if not loop.last %}, {% endif %}
                                        {% endfor %}
                                        </span>
                                    </div>
                                </div>
                                {% endfor %}
                            {% else %}
                                <div class="no-data">No red flag patterns detected</div>
                            {% endif %}
                        </div>
                    </div>
                </div>
                
                <div class="insights-footer">
                    <div class="insights-timestamp">
                        <small>Last updated: {{ landing_insights.last_updated }}</small>
                    </div>
                    <div class="insights-disclaimer">
                        <p>‚ö†Ô∏è <strong>Disclaimer:</strong> This analysis is for data transparency and educational purposes only. It is NOT financial advice. Always conduct your own research and due diligence before making any investment decisions.</p>
                    </div>
                </div>
            </div>
            {% else %}
            <div class="gpt-insights-section">
                <h3 class="insights-title">
                    üìä Dynamic Network Insights
                    <span class="tooltip-icon" title="‚ö†Ô∏è DISCLAIMER: This analysis is for data transparency and educational purposes only. It is NOT financial advice. Always conduct your own research and due diligence before making any investment decisions.">‚ìò</span>
                </h3>
                <div class="insights-cards">
                    <div class="insight-card missing-data">
                        <div class="card-header">
                            <div class="card-icon">üìä</div>
                            <h4>Analysis Unavailable</h4>
                        </div>
                        <div class="card-content">
                            <div class="no-data">Dynamic analysis data is currently unavailable. Please check back later or visit the Insights page for the latest analysis.</div>
                        </div>
                    </div>
                </div>
                <div class="insights-footer">
                </div>
            </div>
            {% endif %}
            
            <div class="cta-buttons">
                <a href="/dash/explorer" class="cta-button primary">
                    <span>Explore Subnets</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
                <a href="/dash/screener" class="cta-button secondary">
                    <span>Screen Opportunities</span>
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M5 12h14M12 5l7 7-7 7"/>
                    </svg>
                </a>
            </div>
            
            <!-- TAO/USDT TradingView Chart -->
            <div class="tradingview-chart-container">
                <div class="chart-header">
                    <h3>TAO/USDT Live Chart</h3>
                    <p>Real-time Bittensor (TAO) price from Binance via TradingView</p>
                </div>
                <div class="tradingview-widget-container">
                    <div id="tradingview_chart"></div>
                </div>
            </div>
            
            <!-- Network Highlights -->
            {% if data_available %}
            <div class="network-highlights">
                <div class="highlight-card">
                    <div class="highlight-icon">üèÜ</div>
                    <div class="highlight-content">
                        <h3>Top Subnet: {{ network_data.top_subnet_name }}</h3>
                        <p>{{ "%.1f"|format(network_data.top_subnet_mcap) }}K TAO Market Cap</p>
                    </div>
                </div>
                <div class="highlight-card">
                    <div class="highlight-icon">‚≠ê</div>
                    <div class="highlight-content">
                        <h3>Highest TAO Score: {{ network_data.highest_tao_score_name }}</h3>
                        <p>Score: {{ "%.1f"|format(network_data.highest_tao_score_value) }} | 7d: {{ "%.1f"|format(network_data.highest_tao_score_momentum) }}%</p>
                    </div>
                </div>
                <div class="highlight-card">
                    <div class="highlight-icon">üìà</div>
                    <div class="highlight-content">
                        <h3>Network Activity</h3>
                        <p>{{ network_data.recent_subnets }} subnets with positive 24h flow</p>
                    </div>
                </div>
            </div>
            {% endif %}

            <!-- Last updated timestamps for TAO price and screener data -->
            <div class="last-updated-section" style="margin-top: 1.5rem; text-align: center;">
                <small>
                    <span>
                        TAO price last updated:
                        {% if network_data and network_data.tao_price_updated %}
                            {{ network_data.tao_price_updated }}
                        {% else %}
                            Unavailable
                        {% endif %}
                        <span class="tooltip-icon" title="Timestamp when the TAO price data was last fetched from CoinGecko API">‚ìò</span>
                    </span>
                    <br/>
                    <span>
                        Subnet screener last updated:
                        {% if network_data and network_data.screener_updated %}
                            {{ network_data.screener_updated }}
                        {% else %}
                            Unavailable
                        {% endif %}
                        <span class="tooltip-icon" title="Timestamp when subnet market data was last fetched from TAO.app API">‚ìò</span>
                    </span>
                </small>
            </div>
        </div>
    </div>

    <section class="features-section">
        <div class="container">
            <h3 class="section-title">Powered by AI Intelligence, Bittensor SDK & TAO.app API</h2>
            <div class="features-grid">
                <div class="feature-card">
                    <div class="feature-icon">ü§ñ</div>
                    <h3>AI-Powered Analysis</h3>
                    <p>AI enriched insights with provenance tracking for every subnet</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <h3>Real-time Metrics</h3>
                    <p>Live market cap, volume, and performance data from Bittensor SDK & <a href="https://tao.app" target="_blank" class="api-link">TAO.app API</a></p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üîç</div>
                    <h3>Smart Filtering</h3>
                    <p>Search and filter by category, tags, and performance metrics</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">‚ö°</div>
                    <h3>Performance Optimized</h3>
                    <p>LRU caching and intelligent data management for fast, responsive analytics</p>
                </div>
            </div>
        </div>
    </section>

    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 TAO Analytics. Built with love for the decentralized future.</p>
            <p class="footer-credits">
                Data powered by Bittensor SDK and <a href="https://tao.app" target="_blank" class="footer-link">TAO.app API</a> ‚Ä¢ 
                Intelligence enhanced by <a href="https://openai.com" target="_blank" class="footer-link">OpenAI APIs</a>
            </p>
            <p class="footer-social">
                <a href="https://www.linkedin.com/in/glenn-landgren/?originalSubdomain=se" target="_blank" class="footer-link">LinkedIn</a> ‚Ä¢ 
                <a href="https://x.com/_landgren_" target="_blank" class="footer-link">X (Twitter)</a>
            </p>
        </div>
    </footer>

    <script>
        // Mobile menu toggle and TradingView initialization
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize TradingView Chart with widget
            const chartContainer = document.getElementById('tradingview_chart');
            console.log('Initializing TradingView chart...');
            
            // Create widget container
            const widgetDiv = document.createElement('div');
            widgetDiv.className = 'tradingview-widget-container__widget';
            chartContainer.appendChild(widgetDiv);
            
            // Create and add script
            const script = document.createElement('script');
            script.type = 'text/javascript';
            script.src = 'https://s3.tradingview.com/external-embedding/embed-widget-symbol-overview.js';
            script.async = true;
            
            // Use TAO/USDT from Binance
            const widgetConfig = {
                "symbols": [["BINANCE:TAOUSDT", "TAOUSDT|1D"]],
                "chartOnly": false,
                "width": "100%",
                "height": "400",
                "locale": "en",
                "colorTheme": "light",
                "autosize": true,
                "showVolume": false,
                "showMA": false,
                "hideDateRanges": false,
                "hideMarketStatus": false,
                "hideSymbolLogo": false,
                "scalePosition": "right",
                "scaleMode": "Normal",
                "fontFamily": "-apple-system, BlinkMacSystemFont, Trebuchet MS, Roboto, Ubuntu, sans-serif",
                "fontSize": "10",
                "noTimeScale": false,
                "valuesTracking": "1",
                "changeMode": "price-and-percent",
                "chartType": "area",
                "maLineColor": "#2962FF",
                "maLineWidth": 1,
                "maLength": 9
            };
            
            script.textContent = JSON.stringify(widgetConfig);
            chartContainer.appendChild(script);
            console.log('TradingView widget script added to DOM');
            
            // Add error handling for widget loading
            script.onerror = function() {
                console.error('TradingView widget failed to load');
                chartContainer.innerHTML = '<div style="display: flex; align-items: center; justify-content: center; height: 400px; background: #f8f9fa; border-radius: 8px; color: #6c757d;"><div style="text-align: center;"><div style="font-size: 2rem; margin-bottom: 1rem;">‚ö†Ô∏è</div><div style="font-size: 1.1rem; margin-bottom: 0.5rem;">Chart Unavailable</div><div style="font-size: 0.9rem;">TradingView widget failed to load</div><button onclick="location.reload()" style="margin-top: 1rem; padding: 0.5rem 1rem; background: #007bff; color: white; border: none; border-radius: 4px; cursor: pointer;">Retry</button></div></div>';
            };
            
            const mobileMenuBtn = document.getElementById('mobile-menu-btn');
            const navLinks = document.getElementById('nav-links');
            
            mobileMenuBtn.addEventListener('click', function() {
                navLinks.classList.toggle('nav-open');
                mobileMenuBtn.classList.toggle('active');
            });
            
            // Close menu when clicking on a link
            const navLinkElements = navLinks.querySelectorAll('.nav-link');
            navLinkElements.forEach(link => {
                link.addEventListener('click', function() {
                    navLinks.classList.remove('nav-open');
                    mobileMenuBtn.classList.remove('active');
                });
            });
            
            // Close menu when clicking outside
            document.addEventListener('click', function(event) {
                if (!mobileMenuBtn.contains(event.target) && !navLinks.contains(event.target)) {
                    navLinks.classList.remove('nav-open');
                    mobileMenuBtn.classList.remove('active');
                }
            });
            
            // Global search functionality
            const searchInput = document.getElementById('global-search-input');
            const searchResults = document.getElementById('search-results');
            let searchTimeout;
            
            searchInput.addEventListener('input', function() {
                const query = this.value.trim();
                
                // Clear previous timeout
                clearTimeout(searchTimeout);
                
                // Allow single character searches (removed minimum length restriction)
                if (query.length === 0) {
                    searchResults.innerHTML = '';
                    searchResults.style.display = 'none';
                    return;
                }
                
                // Debounce search requests
                searchTimeout = setTimeout(() => {
                    fetch(`/api/search?q=${encodeURIComponent(query)}`)
                        .then(response => response.json())
                        .then(data => {
                            if (data.results && data.results.length > 0) {
                                const resultsHtml = data.results.map(result => {
                                    const categoryBadge = result.category ? 
                                        `<span class="search-result-category">${result.category}</span>` : '';
                                    
                                    return `
                                        <a href="/dash/subnet-detail?netuid=${result.netuid}" class="search-result-item">
                                            <div class="search-result-content">
                                                <strong>Subnet ${result.netuid}</strong><br>
                                                <span class="search-result-name">${result.name}</span>
                                                ${categoryBadge}
                                            </div>
                                        </a>
                                    `;
                                }).join('');
                                
                                searchResults.innerHTML = resultsHtml;
                                searchResults.style.display = 'block';
                            } else {
                                searchResults.innerHTML = '<div class="search-no-results">No subnets found</div>';
                                searchResults.style.display = 'block';
                            }
                        })
                        .catch(error => {
                            console.error('Search error:', error);
                            searchResults.innerHTML = '<div class="search-no-results">Search failed</div>';
                            searchResults.style.display = 'block';
                        });
                }, 300); // 300ms debounce
            });
            
            // Handle Enter key
            searchInput.addEventListener('keydown', function(e) {
                if (e.key === 'Enter') {
                    const query = this.value.trim();
                    if (query.length > 0) {
                        // Navigate to first result or search page
                        const firstResult = searchResults.querySelector('.search-result-item');
                        if (firstResult) {
                            window.location.href = firstResult.href;
                        }
                    }
                }
            });
            
            // Close search results when clicking outside
            document.addEventListener('click', function(event) {
                if (!searchInput.contains(event.target) && !searchResults.contains(event.target)) {
                    searchResults.style.display = 'none';
                }
            });
            
            // Close search results when pressing Escape
            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') {
                    searchResults.style.display = 'none';
                    searchInput.blur();
                }
            });
        });
    </script>
    
    <!-- Structured Data (JSON-LD) -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "WebApplication",
        "name": "TAO Analytics",
        "description": "Comprehensive analytics and insights for the Bittensor decentralized AI network",
        "url": "{{ request.url_root }}",
        "applicationCategory": "FinanceApplication",
        "operatingSystem": "Web Browser",
        "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD"
        },
        "creator": {
            "@type": "Organization",
            "name": "TAO Analytics"
        },
        "keywords": "Bittensor, TAO, subnet analytics, decentralized AI, blockchain analytics",
        "featureList": [
            "Real-time subnet analytics",
            "AI-powered insights",
            "Market cap tracking",
            "Network health monitoring",
            "Correlation analysis"
        ],
        "screenshot": "{{ url_for('static', filename='favicon.png', _external=True) }}",
        "softwareVersion": "1.0",
        "datePublished": "2024-01-01",
        "dateModified": "{{ network_data.last_updated if network_data and network_data.last_updated else '2024-01-15' }}"
    }
    </script>
    
    <!-- Additional structured data for organization -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Organization",
        "name": "TAO Analytics",
        "url": "{{ request.url_root }}",
        "logo": "{{ url_for('static', filename='favicon.png', _external=True) }}",
        "description": "Comprehensive analytics and insights for the Bittensor decentralized AI network",
        "sameAs": [
            "https://www.linkedin.com/in/glenn-landgren/?originalSubdomain=se",
            "https://x.com/_landgren_"
        ]
    }
    </script>
</body>
</html> 